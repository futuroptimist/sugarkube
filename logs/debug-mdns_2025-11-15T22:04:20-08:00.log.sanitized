=== System Info ===
sugarkube1
Sun 16 Nov 06:04:20 UTC 2025
[eth0 address details redacted]

=== Avahi Daemon Status ===
● avahi-daemon.service - Avahi mDNS/DNS-SD Stack
     Loaded: loaded (/lib/systemd/system/avahi-daemon.service; enabled; preset: enabled)
     Active: active (running) since Fri 2025-11-14 00:30:15 PST; 1 day 21h ago
TriggeredBy: ● avahi-daemon.socket
   Main PID: 3637 (avahi-daemon)
     Status: "avahi-daemon 0.8 starting up."
[...remaining avahi-daemon status fields unchanged...]
Nov 15 21:47:27 sugarkube1 avahi-daemon[3637]: No service file found in /etc/avahi/services.

=== Check if mDNS port is listening ===
udp        0      0 0.0.0.0:5353            0.0.0.0:*                           3637/avahi-daemon

=== Test local mDNS resolution ===
sugarkube1.local    <REDACTED_IPV6>
sugarkube0.local    <REDACTED_IPV6>

=== Browse all mDNS services (5 second timeout) ===
+   eth0 IPv4 k3s-sugar-dev@sugarkube0.local (server)       _k3s-sugar-dev._tcp  local
+   eth0 IPv4 sugarkube1 [<REDACTED_MAC>]                   Workstation          local
+   eth0 IPv4 sugarkube2 [<REDACTED_MAC>]                   Workstation          local
+   eth0 IPv4 sugarkube0 [<REDACTED_MAC>]                   Workstation          local
=   eth0 IPv4 k3s-sugar-dev@sugarkube0.local (server)       _k3s-sugar-dev._tcp  local
   hostname = [sugarkube0.local]
   address = [<REDACTED_IPV4>]
   port = [6443]
   txt = [
     "ip6=<REDACTED_IPV6>"
     "ip4=<REDACTED_IPV4>"
     "host=sugarkube0.local"
     "leader=sugarkube0.local"
     "phase=server"
     "role=server"
     "env=dev"
     "cluster=sugar"
     "k3s=1"
   ]
Got SIGTERM, quitting.
Browse timed out or no services found

=== Browse specific k3s service (5 second timeout) ===
+   eth0 IPv4 k3s-sugar-dev@sugarkube0.local (server)       _k3s-sugar-dev._tcp  local
=   eth0 IPv4 k3s-sugar-dev@sugarkube0.local (server)       _k3s-sugar-dev._tcp  local
   hostname = [sugarkube0.local]
   address = [<REDACTED_IPV4>]
   port = [6443]
   txt = [
     "ip6=<REDACTED_IPV6>"
     "ip4=<REDACTED_IPV4>"
     "host=sugarkube0.local"
     "leader=sugarkube0.local"
     "phase=server"
     "role=server"
     "env=dev"
     "cluster=sugar"
     "k3s=1"
   ]

=== Check for multicast route ===
[no multicast-specific routes configured]

=== Check firewall rules ===
sudo: iptables: command not found
No explicit firewall rules for mDNS
UFW not installed/active

=== Check if we can ping sugarkube0 ===
PING sugarkube0.local (<REDACTED_IPV4>) 56(84) bytes of data.
64 bytes from sugarkube0.lan: icmp_seq=1 ttl=64 time=0.267 ms
64 bytes from sugarkube0.lan: icmp_seq=2 ttl=64 time=0.248 ms
64 bytes from sugarkube0.lan: icmp_seq=3 ttl=64 time=0.244 ms

--- sugarkube0.local ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2002ms
rtt min/avg/max/mdev = 0.244/0.253/0.267/0.010 ms

=== Try to discover k3s service on sugarkube0 specifically ===
+   eth0 IPv4 k3s-sugar-dev@sugarkube0.local (server)       _k3s-sugar-dev._tcp  local
=   eth0 IPv4 k3s-sugar-dev@sugarkube0.local (server)       _k3s-sugar-dev._tcp  local
   hostname = [sugarkube0.local]
   txt = [
     "ip6=<REDACTED_IPV6>"
     "ip4=<REDACTED_IPV4>"
     "host=sugarkube0.local"
     "leader=sugarkube0.local"
     "phase=server"
     "role=server"
     "env=dev"
     "cluster=sugar"
     "k3s=1"
   ]

=== Check nsswitch.conf for mDNS ===
hosts:          files mdns4_minimal [NOTFOUND=return] dns

=== Test if we can reach sugarkube0's k3s API ===
[ curl -k --connect-timeout 5 https://sugarkube0.local:6443/ping ]
pong
[ curl -k --connect-timeout 5 https://<REDACTED_IPV4>:6443/ping ]
pong

=== Check for multicast group membership ===
2:  eth0
    [multicast group membership entries for 224.0.0.251, 224.0.0.1, and ff02::/ff01:: groups]

=== Capture mDNS traffic (5 second sample) ===
tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
[1 mDNS packet captured during sample window]
1 packet captured
4 packets received by filter
0 packets dropped by kernel
Cannot capture mDNS traffic

=== Check Avahi daemon logs (last 50 lines) ===
Nov 14 18:45:35 sugarkube1 avahi-daemon[3637]: Files changed, reloading.
Nov 14 18:45:35 sugarkube1 avahi-daemon[3637]: No service file found in /etc/avahi/services.
[...many repeated "Files changed, reloading." / "No service file found in /etc/avahi/services." lines...]
Nov 15 21:47:27 sugarkube1 avahi-daemon[3637]: No service file found in /etc/avahi/services.

=== DONE ===
