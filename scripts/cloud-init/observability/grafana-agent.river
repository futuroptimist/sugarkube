logging {
  level = "${GRAFANA_AGENT_LOG_LEVEL}"
}

prometheus.exporter "agent" {
  listen_address = "0.0.0.0"
  listen_port = 12345
}

prometheus.scrape "node" {
  scrape_interval = "${GRAFANA_AGENT_SCRAPE_INTERVAL}"
  static_configs = [{
    targets = ["${GRAFANA_AGENT_NODE_EXPORTER_ADDRESS}"],
    labels = {
      job = "node-exporter",
      cluster = "${GRAFANA_AGENT_CLUSTER_LABEL}"
    }
  }]
  forward_to = [prometheus.exporter.agent.receiver]
}

prometheus.scrape "cadvisor" {
  scrape_interval = "${GRAFANA_AGENT_SCRAPE_INTERVAL}"
  static_configs = [{
    targets = ["${GRAFANA_AGENT_CADVISOR_ADDRESS}"],
    labels = {
      job = "cadvisor",
      cluster = "${GRAFANA_AGENT_CLUSTER_LABEL}"
    }
  }]
  forward_to = [prometheus.exporter.agent.receiver]
}
