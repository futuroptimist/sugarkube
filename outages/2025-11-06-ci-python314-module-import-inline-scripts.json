{
  "id": "ci-python314-module-import-inline-scripts",
  "date": "2025-11-06",
  "component": "k3s Discovery - mDNS Query",
  "rootCause": "Python 3.14 changed how module imports work when using 'python3 -' with stdin scripts. The k3s-discover.sh script contains inline Python code that imports modules from the scripts directory (k3s_mdns_query, k3s_mdns_parser, mdns_helpers). While PYTHONPATH was set at the shell level, Python 3.14's stdin script handling doesn't consistently honor PYTHONPATH, causing import failures and empty results in mDNS discovery tests.",
  "resolution": "Modified inline Python scripts in k3s-discover.sh to explicitly add SCRIPT_DIR to sys.path before importing modules. This ensures Python 3.14+ compatibility by programmatically setting the module search path rather than relying solely on PYTHONPATH environment variable. Tests in test_mdns_discovery_parsing.py now pass.",
  "references": [
    "scripts/k3s-discover.sh",
    "tests/test_mdns_discovery_parsing.py",
    "scripts/k3s_mdns_query.py"
  ]
}
