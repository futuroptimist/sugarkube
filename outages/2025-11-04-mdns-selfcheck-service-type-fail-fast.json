{
  "id": "2025-11-04-mdns-selfcheck-service-type-fail-fast",
  "date": "2025-11-04",
  "component": "scripts/mdns_type_check.sh",
  "rootCause": "Service type enumeration fail-fast logic (exit code 4) triggers even when instances are discovered during the active query window. Test 'mdns self-check warns when enumeration misses but browse succeeds' expects the script to continue when service type is missing from enumeration but instances are found via active browse, however the script exits early with code 4.",
  "resolution": "The logic at mdns_type_check.sh:281-305 needs review. When type_present=0 but active_found=1, the script should continue to the main retry loop instead of exiting. The current condition 'if [ \"${type_present}\" -eq 0 ] && [ \"${active_found}\" -eq 0 ]' is correct, but active_found may not be getting set properly due to the awk hang issue.",
  "references": [
    "tests/bats/mdns_selfcheck.bats:158-200",
    "scripts/mdns_type_check.sh:278-305",
    "notes/ci-test-failures-remaining-work.md:45-51"
  ]
}
