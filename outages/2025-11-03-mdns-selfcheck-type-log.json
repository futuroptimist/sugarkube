{
  "id": "mdns-selfcheck-type-log",
  "date": "2025-11-03",
  "component": "scripts/mdns_selfcheck.sh",
  "rootCause": "The mdns_type_check case statement ended the SERVICE_TYPE branch with ;; so the logic never flowed into the collector that appends service types. As a result available_types omitted _k3s-sugar-dev._tcp, breaking bats assertions that rely on the advertised type list.",
  "resolution": "Allow the SERVICE_TYPE match to fall through with ;;& so the same record also reaches the aggregator path and the expected service type is logged.",
  "references": [
    "https://github.com/futuroptimist/sugarkube/actions/runs/19026011519/job/54329923153?pr=1663"
  ],
  "tests": [
    "BATS_PRINT_OUTPUT_ON_FAILURE=1 bats --filter \"^mdns self-check succeeds when instance is discoverable$\" tests/bats/mdns_selfcheck.bats"
  ]
}
