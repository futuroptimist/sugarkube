{
  "id": "2025-11-04-mdns-selfcheck-test-10-type-missing-exit",
  "date": "2025-11-04",
  "component": "tests/bats/mdns_selfcheck.bats:454",
  "rootCause": "Test 'mdns self-check fails fast when service type is missing' expects exit code 4 when service type is completely missing from enumeration and no instances found. Test uses avahi_browse_services_without_k3s.txt which only has _http._tcp and _ssh._tcp. The script should detect this early and exit with code 4, but is returning a different exit code.",
  "resolution": "The fail-fast logic in mdns_type_check.sh:281-305 should trigger when type_present=0 and active_found=0. Investigation shows this logic exists but may not be reached due to earlier failures (like the awk hang). Or the exit code 4 is being overridden by error handling elsewhere in the script.",
  "references": [
    "tests/bats/mdns_selfcheck.bats:454-495",
    "scripts/mdns_type_check.sh:278-305",
    "notes/final-summary.md:49-52"
  ]
}
