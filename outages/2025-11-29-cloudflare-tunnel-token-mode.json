{
  "id": "2025-11-29-cloudflare-tunnel-token-mode",
  "date": "2025-11-29",
  "component": "cloudflare-tunnel dev env token-only mode",
  "rootCause": "Cloudflare Tunnel pods on the Raspberry Pi k3s cluster crash-looped with origin certificate errors because cloudflared continued using the locally-managed credentials flow even when deployed for token-only remote-managed tunnels. The tunnel was either configured as locally-managed or the deployment still implied credentials-based auth instead of the TUNNEL_TOKEN path.",
  "resolution": "Aligned the cloudflared Deployment with Cloudflare's remote-managed token guidance: inject TUNNEL_TOKEN from a Secret, run 'cloudflared tunnel --no-autoupdate --metrics 0.0.0.0:2000 run' without passing --token on the CLI, drop all config/credential mounts, and add clearer debug messaging to steer operators toward remote-managed tunnels when origin-cert errors appear.",
  "references": [
    "https://github.com/futuroptimist/sugarkube/commit/18454b08f0b91d7b650132af4074f5fcc9c1c992",
    "https://developers.cloudflare.com/cloudflare-one/connections/connect-networks/get-started/tunnel-guide/remote/",
    "https://developers.cloudflare.com/cloudflare-one/connections/connect-networks/get-started/kubernetes/",
    "https://github.com/cloudflare/cloudflared/issues/669"
  ]
}
