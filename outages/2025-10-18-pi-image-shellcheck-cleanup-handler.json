{
  "id": "2025-10-18-pi-image-shellcheck-cleanup-handler",
  "date": "2025-10-18",
  "component": "pi-image workflow",
  "rootCause": "ShellCheck flagged the new SDâ†’NVMe helpers. `cleanup_handler` in `scripts/cleanup_clone_mounts.sh` exited with an unquoted status and no suppression for its trap-only control flow, triggering SC2086/SC2317, and `scripts/finalize_nvme.sh` kept an unused `SCRIPT_NAME` constant (SC2034). The workflow treats any ShellCheck warning as a failure, so the unit job stopped before running the remaining tests.",
  "resolution": "Quote the exit statuses in `cleanup_handler`, document the trap-only function with `shellcheck disable=SC2317`, and drop the unused constant from `scripts/finalize_nvme.sh` so the shellcheck step runs cleanly.",
  "references": [
    "scripts/cleanup_clone_mounts.sh",
    "scripts/finalize_nvme.sh",
    ".github/workflows/pi-image.yml"
  ]
}
