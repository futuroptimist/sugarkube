{
  "id": "2025-10-27-mdns-relaxed-retry-overused",
  "date": "2025-10-27",
  "component": "scripts/k3s-discover.sh",
  "rootCause": "Discovery retried the mDNS self-check in relaxed mode even when the strict failure was not an IPv4 mismatch (e.g., instance_not_found). This doubled wait time without improving success and produced misleading logs.",
  "resolution": "Teach ensure_self_mdns_advertisement to only perform the relaxed retry when mdns_selfcheck.sh exits with code 5 (explicit IPv4 mismatch). All other failures now short-circuit to diagnostics.",
  "references": [
    "scripts/k3s-discover.sh",
    "scripts/mdns_selfcheck.sh",
    "tests/bats/mdns_selfcheck.bats"
  ]
}
